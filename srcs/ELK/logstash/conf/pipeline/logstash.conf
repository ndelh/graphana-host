input {
	beats {
		port => 5044
		ssl => true
		ssl_certificate => "/usr/share/logstash/config/certs/logstash/logstash.crt"
		ssl_key => "/usr/share/logstash/config/certs/logstash/logstash.key"
		ssl_verify_mode => "none"
	}
}

filter {
	kv {
		source => "message"
		field_split => " "
	}

	mutate {
		remove_field => [ "[container][labels]", "[docker][container]", "[agent]", "[ecs]", "[log][offset]", "[event][original]" ] 
	}
if [status] {
	mutate {
		convert => { "status" => "integer" }
		}
	}
}

output {
	elasticsearch {
		hosts => ["https://elasticsearch:9200"]
		ssl => true
		cacert => "/usr/share/logstash/config/certs/ca.crt"
		index => "grafana-logstash-%{+YYYY.MM.dd}"
		user =>  "elastic"
		password => "${LOGSTASH_PASSWORD}"
	}	
}
